<!DOCTYPE html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Artificial Neural Networks and Deep Learning course at Insper"><meta name=author content="Sandmann, H."><link href=https://insper.github.io/ann-dl/classes/deep-learning/ rel=canonical><link href=../metrics/generative/ rel=prev><link href=../convolutional-neural-networks/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.23"><title>10. Deep Learning - Artificial Neural Networks and Deep Learning</title><link rel=stylesheet href=../../assets/stylesheets/main.84d31ad4.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M64%20480c-35.3%200-64-28.7-64-64V96c0-35.3%2028.7-64%2064-64h320c35.3%200%2064%2028.7%2064%2064v213.5c0%2017-6.7%2033.3-18.7%2045.3L322.7%20461.3c-12%2012-28.3%2018.7-45.3%2018.7zm325.5-176H296c-13.3%200-24%2010.7-24%2024v93.5z%22/%3E%3C/svg%3E');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M384%20512H96c-53%200-96-43-96-96V96C0%2043%2043%200%2096%200h304c26.5%200%2048%2021.5%2048%2048v288c0%2020.9-13.4%2038.7-32%2045.3V448c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032zM96%20384c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h256v-64zm32-232c0%2013.3%2010.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24H152c-13.3%200-24%2010.7-24%2024m24%2072c-13.3%200-24%2010.7-24%2024s10.7%2024%2024%2024h176c13.3%200%2024-10.7%2024-24s-10.7-24-24-24z%22/%3E%3C/svg%3E');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m-32-352a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200m-8%2064h48c13.3%200%2024%2010.7%2024%2024v88h8c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-80c-13.3%200-24-10.7-24-24s10.7-24%2024-24h24v-64h-24c-13.3%200-24-10.7-24-24s10.7-24%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M461.2%2018.9C472.7%2024%20480%2035.4%20480%2048v416c0%2012.6-7.3%2024-18.8%2029.1s-24.8%203.2-34.3-5.1l-46.6-40.7c-43.6-38.1-98.7-60.3-156.4-63V480c0%2017.7-14.3%2032-32%2032h-32c-17.7%200-32-14.3-32-32v-96C57.3%20384%200%20326.7%200%20256s57.3-128%20128-128h84.5c61.8-.2%20121.4-22.7%20167.9-63.3L427%2024c9.4-8.3%2022.9-10.2%2034.3-5.1zM224%20320v.2c70.3%202.7%20137.8%2028.5%20192%2073.4V118.3c-54.2%2044.9-121.7%2070.7-192%2073.4z%22/%3E%3C/svg%3E');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M434.8%2070.1c14.3%2010.4%2017.5%2030.4%207.1%2044.7l-256%20352c-5.5%207.6-14%2012.3-23.4%2013.1s-18.5-2.7-25.1-9.3l-128-128c-12.5-12.5-12.5-32.8%200-45.3s32.8-12.5%2045.3%200l101.5%20101.5%20234-321.7c10.4-14.3%2030.4-17.5%2044.7-7.1z%22/%3E%3C/svg%3E');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%20512a256%20256%200%201%200%200-512%20256%20256%200%201%200%200%20512m0-336c-17.7%200-32%2014.3-32%2032%200%2013.3-10.7%2024-24%2024s-24-10.7-24-24c0-44.2%2035.8-80%2080-80s80%2035.8%2080%2080c0%2047.2-36%2067.2-56%2074.5v3.8c0%2013.3-10.7%2024-24%2024s-24-10.7-24-24v-8.1c0-20.5%2014.8-35.2%2030.1-40.2%206.4-2.1%2013.2-5.5%2018.2-10.3%204.3-4.2%207.7-10%207.7-19.6%200-17.7-14.3-32-32-32zm-32%20192a32%2032%200%201%201%2064%200%2032%2032%200%201%201-64%200%22/%3E%3C/svg%3E');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M256%200c14.7%200%2028.2%208.1%2035.2%2021l216%20400c6.7%2012.4%206.4%2027.4-.8%2039.5S486.1%20480%20472%20480H40c-14.1%200-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9%2020.5-21%2035.2-21m0%20352a32%2032%200%201%200%200%2064%2032%2032%200%201%200%200-64m0-192c-18.2%200-32.7%2015.5-31.4%2033.7l7.4%20104c.9%2012.5%2011.4%2022.3%2023.9%2022.3%2012.6%200%2023-9.7%2023.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z%22/%3E%3C/svg%3E');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20576%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M480-16c6.9%200%2013%204.4%2015.2%2010.9l13.5%2040.4%2040.4%2013.5C555.6%2051%20560%2057.1%20560%2064s-4.4%2013-10.9%2015.2l-40.4%2013.5-13.5%2040.4c-2.2%206.5-8.3%2010.9-15.2%2010.9s-13-4.4-15.2-10.9l-13.5-40.4-40.4-13.5C404.4%2077%20400%2070.9%20400%2064s4.4-13%2010.9-15.2l40.4-13.5%2013.5-40.4C467-11.6%20473.1-16%20480-16M321.4%2097.4c12.5-12.5%2032.8-12.5%2045.3%200l80%2080c12.5%2012.5%2012.5%2032.8%200%2045.3l-10.9%2010.9c7.9%2022%2012.2%2045.7%2012.2%2070.5%200%20114.9-93.1%20208-208%20208S32%20418.9%2032%20304%20125.1%2096%20240%2096c24.7%200%2048.5%204.3%2070.5%2012.3zM144%20304c0-53%2043-96%2096-96%2013.3%200%2024-10.7%2024-24s-10.7-24-24-24c-79.5%200-144%2064.5-144%20144%200%2013.3%2010.7%2024%2024%2024s24-10.7%2024-24%22/%3E%3C/svg%3E');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20512%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M416%20427.4c58.5-44%2096-111.6%2096-187.4C512%20107.5%20397.4%200%20256%200S0%20107.5%200%20240c0%2075.8%2037.5%20143.4%2096%20187.4V464c0%2026.5%2021.5%2048%2048%2048h32v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h64v-40c0-13.3%2010.7-24%2024-24s24%2010.7%2024%2024v40h32c26.5%200%2048-21.5%2048-48zM96%20256a64%2064%200%201%201%20128%200%2064%2064%200%201%201-128%200m256-64a64%2064%200%201%201%200%20128%2064%2064%200%201%201%200-128%22/%3E%3C/svg%3E');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20640%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M352%200c0-17.7-14.3-32-32-32s-32%2014.3-32%2032v64h-96c-53%200-96%2043-96%2096v224c0%2053%2043%2096%2096%2096h256c53%200%2096-43%2096-96V160c0-53-43-96-96-96h-96zM160%20368c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24m120%200c0-13.3%2010.7-24%2024-24h32c13.3%200%2024%2010.7%2024%2024s-10.7%2024-24%2024h-32c-13.3%200-24-10.7-24-24M224%20176a48%2048%200%201%201%200%2096%2048%2048%200%201%201%200-96m144%2048a48%2048%200%201%201%2096%200%2048%2048%200%201%201-96%200m-304%200c0-17.7-14.3-32-32-32S0%20206.3%200%20224v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32zm544-32c-17.7%200-32%2014.3-32%2032v96c0%2017.7%2014.3%2032%2032%2032s32-14.3%2032-32v-96c0-17.7-14.3-32-32-32%22/%3E%3C/svg%3E');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M288%200H128c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032v151.5L7.5%20426.3C2.6%20435%200%20444.7%200%20454.7%200%20486.4%2025.6%20512%2057.3%20512h333.4c31.6%200%2057.3-25.6%2057.3-57.3%200-10-2.6-19.8-7.5-28.4L320%20215.5V64c17.7%200%2032-14.3%2032-32S337.7%200%20320%200zm-96%20215.5V64h64v151.5c0%2011.1%202.9%2022.1%208.4%2031.8L306%20320H142l41.6-72.7c5.5-9.7%208.4-20.6%208.4-31.8%22/%3E%3C/svg%3E');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20viewBox%3D%220%200%20448%20512%22%3E%3C%21--%21%20Font%20Awesome%20Free%207.1.0%20by%20%40fontawesome%20-%20https%3A//fontawesome.com%20License%20-%20https%3A//fontawesome.com/license/free%20%28Icons%3A%20CC%20BY%204.0%2C%20Fonts%3A%20SIL%20OFL%201.1%2C%20Code%3A%20MIT%20License%29%20Copyright%202025%20Fonticons%2C%20Inc.--%3E%3Cpath%20d%3D%22M0%20216C0%20149.7%2053.7%2096%20120%2096h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064H64c-35.3%200-64-28.7-64-64zm256%200c0-66.3%2053.7-120%20120-120h8c17.7%200%2032%2014.3%2032%2032s-14.3%2032-32%2032h-8c-30.9%200-56%2025.1-56%2056v8h64c35.3%200%2064%2028.7%2064%2064v64c0%2035.3-28.7%2064-64%2064h-64c-35.3%200-64-28.7-64-64z%22/%3E%3C/svg%3E');}</style><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/stylesheets/neoteroi-mkdocs.min.css><link rel=stylesheet href=../../assets/stylesheets/neoteroi-timeline.css><link rel=stylesheet href=../../assets/stylesheets/extra.css><link rel=stylesheet href=../../assets/stylesheets/badge.css><link rel=stylesheet href=../../termynal.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><link href=../../assets/stylesheets/glightbox.min.css rel=stylesheet><script src=../../assets/javascripts/glightbox.min.js></script><style id=glightbox-style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#key-components class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Artificial Neural Networks and Deep Learning" class="md-header__button md-logo" aria-label="Artificial Neural Networks and Deep Learning" data-md-component=logo> <img src=../../assets/images/ann-dl.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Artificial Neural Networks and Deep Learning </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 10. Deep Learning </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_3 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"></path></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_3> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/insper/ann-dl title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> insper/ann-dl </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Artificial Neural Networks and Deep Learning" class="md-nav__button md-logo" aria-label="Artificial Neural Networks and Deep Learning" data-md-component=logo> <img src=../../assets/images/ann-dl.png alt=logo> </a> Artificial Neural Networks and Deep Learning </label> <div class=md-nav__source> <a href=https://github.com/insper/ann-dl title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"></path></svg> </div> <div class=md-source__repository> insper/ann-dl </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Ementa </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/ class=md-nav__link> <span class=md-ellipsis> 2025.2 </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Classes </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Classes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../concepts/ class=md-nav__link> <span class=md-ellipsis> 1. Concepts </span> </a> </li> <li class=md-nav__item> <a href=../data/ class=md-nav__link> <span class=md-ellipsis> 2. Data </span> </a> </li> <li class=md-nav__item> <a href=../preprocessing/ class=md-nav__link> <span class=md-ellipsis> 3. Preprocessing </span> </a> </li> <li class=md-nav__item> <a href=../ann/ class=md-nav__link> <span class=md-ellipsis> 4. Neural Networks </span> </a> </li> <li class=md-nav__item> <a href=../perceptron/ class=md-nav__link> <span class=md-ellipsis> 5. Perceptron </span> </a> </li> <li class=md-nav__item> <a href=../mlp/ class=md-nav__link> <span class=md-ellipsis> 6. Multi-Layer Perceptron </span> </a> </li> <li class=md-nav__item> <a href=../optimization/ class=md-nav__link> <span class=md-ellipsis> 7. Optimization </span> </a> </li> <li class=md-nav__item> <a href=../regularization/ class=md-nav__link> <span class=md-ellipsis> 8. Regularization </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9 id=__nav_3_9_label tabindex=0> <span class=md-ellipsis> 9. Metrics and Evaluation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_9_label aria-expanded=false> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> 9. Metrics and Evaluation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../metrics/classification/ class=md-nav__link> <span class=md-ellipsis> 9.1. Classification </span> </a> </li> <li class=md-nav__item> <a href=../metrics/regression/ class=md-nav__link> <span class=md-ellipsis> 9.2. Regression </span> </a> </li> <li class=md-nav__item> <a href=../metrics/generative/ class=md-nav__link> <span class=md-ellipsis> 9.3. Generative </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 10. Deep Learning </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 10. Deep Learning </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#key-components class=md-nav__link> <span class=md-ellipsis> Key Components </span> </a> </li> <li class=md-nav__item> <a href=#different-types-of-layers class=md-nav__link> <span class=md-ellipsis> Different Types of Layers </span> </a> </li> <li class=md-nav__item> <a href=#common-deep-learning-architectures class=md-nav__link> <span class=md-ellipsis> Common Deep Learning Architectures </span> </a> </li> <li class=md-nav__item> <a href=#forward-and-backward-pass-for-each-layer class=md-nav__link> <span class=md-ellipsis> Forward and Backward Pass for Each Layer </span> </a> <nav class=md-nav aria-label="Forward and Backward Pass for Each Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a-dense-fully-connected class=md-nav__link> <span class=md-ellipsis> A. Dense (Fully Connected) </span> </a> </li> <li class=md-nav__item> <a href=#b-convolutional class=md-nav__link> <span class=md-ellipsis> B. Convolutional </span> </a> </li> <li class=md-nav__item> <a href=#c-pooling-max-pooling class=md-nav__link> <span class=md-ellipsis> C. Pooling (Max Pooling) </span> </a> </li> <li class=md-nav__item> <a href=#d-recurrent-lstm class=md-nav__link> <span class=md-ellipsis> D. Recurrent (LSTM) </span> </a> </li> <li class=md-nav__item> <a href=#e-embedding class=md-nav__link> <span class=md-ellipsis> E. Embedding </span> </a> </li> <li class=md-nav__item> <a href=#f-attention-scaled-dot-product class=md-nav__link> <span class=md-ellipsis> F. Attention (Scaled Dot-Product) </span> </a> </li> <li class=md-nav__item> <a href=#g-normalization-batch-normalization class=md-nav__link> <span class=md-ellipsis> G. Normalization (Batch Normalization) </span> </a> </li> <li class=md-nav__item> <a href=#h-dropout class=md-nav__link> <span class=md-ellipsis> H. Dropout </span> </a> </li> <li class=md-nav__item> <a href=#i-flatten class=md-nav__link> <span class=md-ellipsis> I. Flatten </span> </a> </li> <li class=md-nav__item> <a href=#j-activation-relu class=md-nav__link> <span class=md-ellipsis> J. Activation (ReLU) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../convolutional-neural-networks/ class=md-nav__link> <span class=md-ellipsis> 11. Convolutional </span> </a> </li> <li class=md-nav__item> <a href=../generative-models/ class=md-nav__link> <span class=md-ellipsis> 12. Generative Models </span> </a> </li> <li class=md-nav__item> <a href=../generative-adversarial-networks/ class=md-nav__link> <span class=md-ellipsis> 13. GAN </span> </a> </li> <li class=md-nav__item> <a href=../variational-autoencoders/ class=md-nav__link> <span class=md-ellipsis> 14. VAE </span> </a> </li> <li class=md-nav__item> <a href=../clip/ class=md-nav__link> <span class=md-ellipsis> 15. CLIP </span> </a> </li> <li class=md-nav__item> <a href=../stable-diffusion/ class=md-nav__link> <span class=md-ellipsis> 16. Stable Diffusion </span> </a> </li> <li class=md-nav__item> <a href=../flow-matching/ class=md-nav__link> <span class=md-ellipsis> 17. Flow-Matching </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Definitions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Definitions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../definitions/latent_space_vs_embedding/ class=md-nav__link> <span class=md-ellipsis> Latent Space vs. Embedding </span> </a> </li> <li class=md-nav__item> <a href=../../definitions/stable_difussion_vs_flow-matching/ class=md-nav__link> <span class=md-ellipsis> Stable Diffusion vs. Flow-Matching </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../references/ class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> Versions </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Versions </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/terms-and-conditions/ class=md-nav__link> <span class=md-ellipsis> Terms and Conditions </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <label class=md-nav__link for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class=md-ellipsis> 2025.2 </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> 2025.2 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/ class=md-nav__link> <span class=md-ellipsis> 2025.2 </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_2> <label class=md-nav__link for=__nav_6_2_2 id=__nav_6_2_2_label tabindex=0> <span class=md-ellipsis> Exercises </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_2> <span class="md-nav__icon md-icon"></span> Exercises </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/exercises/data/ class=md-nav__link> <span class=md-ellipsis> 1. Data </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/exercises/perceptron/ class=md-nav__link> <span class=md-ellipsis> 2. Perceptron </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/exercises/mlp/ class=md-nav__link> <span class=md-ellipsis> 3. MLP </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/exercises/vae/ class=md-nav__link> <span class=md-ellipsis> 4. VAE </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2_3> <label class=md-nav__link for=__nav_6_2_3 id=__nav_6_2_3_label tabindex=0> <span class=md-ellipsis> Projects </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2_3> <span class="md-nav__icon md-icon"></span> Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../versions/2025.2/projects/classification/ class=md-nav__link> <span class=md-ellipsis> 1. Classification </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/projects/regression/ class=md-nav__link> <span class=md-ellipsis> 2. Regression </span> </a> </li> <li class=md-nav__item> <a href=../../versions/2025.2/projects/generative/ class=md-nav__link> <span class=md-ellipsis> 3. Generative </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#key-components class=md-nav__link> <span class=md-ellipsis> Key Components </span> </a> </li> <li class=md-nav__item> <a href=#different-types-of-layers class=md-nav__link> <span class=md-ellipsis> Different Types of Layers </span> </a> </li> <li class=md-nav__item> <a href=#common-deep-learning-architectures class=md-nav__link> <span class=md-ellipsis> Common Deep Learning Architectures </span> </a> </li> <li class=md-nav__item> <a href=#forward-and-backward-pass-for-each-layer class=md-nav__link> <span class=md-ellipsis> Forward and Backward Pass for Each Layer </span> </a> <nav class=md-nav aria-label="Forward and Backward Pass for Each Layer"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#a-dense-fully-connected class=md-nav__link> <span class=md-ellipsis> A. Dense (Fully Connected) </span> </a> </li> <li class=md-nav__item> <a href=#b-convolutional class=md-nav__link> <span class=md-ellipsis> B. Convolutional </span> </a> </li> <li class=md-nav__item> <a href=#c-pooling-max-pooling class=md-nav__link> <span class=md-ellipsis> C. Pooling (Max Pooling) </span> </a> </li> <li class=md-nav__item> <a href=#d-recurrent-lstm class=md-nav__link> <span class=md-ellipsis> D. Recurrent (LSTM) </span> </a> </li> <li class=md-nav__item> <a href=#e-embedding class=md-nav__link> <span class=md-ellipsis> E. Embedding </span> </a> </li> <li class=md-nav__item> <a href=#f-attention-scaled-dot-product class=md-nav__link> <span class=md-ellipsis> F. Attention (Scaled Dot-Product) </span> </a> </li> <li class=md-nav__item> <a href=#g-normalization-batch-normalization class=md-nav__link> <span class=md-ellipsis> G. Normalization (Batch Normalization) </span> </a> </li> <li class=md-nav__item> <a href=#h-dropout class=md-nav__link> <span class=md-ellipsis> H. Dropout </span> </a> </li> <li class=md-nav__item> <a href=#i-flatten class=md-nav__link> <span class=md-ellipsis> I. Flatten </span> </a> </li> <li class=md-nav__item> <a href=#j-activation-relu class=md-nav__link> <span class=md-ellipsis> J. Activation (ReLU) </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>10. Deep Learning</h1> <p>Deep learning is a subset of machine learning (which itself is part of artificial intelligence) that focuses on training artificial neural networks with multiple layers to learn and make predictions from complex data. These networks are inspired by the human brain's structure, where "neurons" process information and pass it along.</p> <p>Unlike traditional machine learning algorithms (e.g., linear regression or decision trees), which often require manual feature engineering (hand-picking important data characteristics), deep learning models automatically extract features from raw data through layers of processing. This makes them powerful for tasks like image recognition, natural language processing, speech synthesis, and more.</p> <p>Deep learning excels with large datasets and high computational power (e.g., GPUs), but it can be "black-box" in nature—meaning it's sometimes hard to interpret why a model makes a specific decision.</p> <p>The core building block is the <strong>artificial neural network (ANN)</strong>, which consists of interconnected nodes (neurons) organized into layers. Data flows from the input layer, through hidden layers (where the "deep" part comes in, with many layers stacked), to the output layer. Training involves adjusting weights (connections between neurons) using algorithms like backpropagation to minimize errors.</p> <h2 id=key-components>Key Components</h2> <p>A typical neural network has three main parts:</p> <ul> <li><strong>Input Layer</strong>: The entry point where raw data (e.g., pixel values from an image) is fed into the network. It doesn't perform computations; it just passes data forward.</li> <li><strong>Hidden Layers</strong>: The "depth" of deep learning. These are where the magic happens—multiple stacked layers that transform the data through mathematical operations. Each layer learns increasingly abstract representations (e.g., from edges in an image to full objects).</li> <li><strong>Output Layer</strong>: The final layer that produces the prediction or classification (e.g., "cat" or "dog" in an image classifier).</li> </ul> <h2 id=different-types-of-layers>Different Types of Layers</h2> <p>Deep learning models use various specialized layers depending on the task and architecture. Here's an overview of common layer types, grouped by their typical use. The following table summarizes their characteristics:</p> <table> <thead> <tr> <th>Layer Type</th> <th>Description</th> <th>Common Use Cases</th> <th>How It Works</th> </tr> </thead> <tbody> <tr> <td><a href=#a-dense-fully-connected><strong>Dense (Fully Connected)</strong></a></td> <td>Every neuron in this layer is connected to every neuron in the previous layer. It's the most basic type.</td> <td>General-purpose networks, like simple classifiers or regressors. Often used in the final stages of more complex models.</td> <td>Applies a linear transformation (weights * inputs + bias) followed by an activation function (e.g., ReLU) to introduce non-linearity.</td> </tr> <tr> <td><a href=#b-convolutional><strong>Convolutional</strong></a></td> <td>Uses filters (kernels) to scan input data, detecting local patterns like edges or textures. Key to "convolutional neural networks" (CNNs).</td> <td>Image and video processing, computer vision (e.g., object detection in photos).</td> <td>Slides filters over the input, computing dot products to create feature maps. Reduces spatial dimensions while preserving important features.</td> </tr> <tr> <td><a href=#c-pooling-max-pooling><strong>Pooling</strong></a></td> <td>Downsamples the output from convolutional layers, reducing computational load and preventing overfitting. Types include max pooling (takes the maximum value) and average pooling.</td> <td>Follows convolutional layers in CNNs to summarize features.</td> <td>Aggregates values in small regions (e.g., 2x2 grid) into a single value, making the model more robust to variations like translations.</td> </tr> <tr> <td><a href=#d-recurrent-lstm><strong>Recurrent</strong></a> (e.g., RNN, LSTM, GRU)</td> <td>Handles sequential data by maintaining a "memory" of previous inputs via loops. LSTM (Long Short-Term Memory) and GRU (Gated Recurrent Unit) are advanced variants that address vanishing gradient issues.</td> <td>Time-series forecasting, natural language processing (e.g., machine translation), speech recognition.</td> <td>Processes inputs one step at a time, using hidden states to carry information forward. Good for sequences but can struggle with long dependencies.</td> </tr> <tr> <td><a href=#e-embedding><strong>Embedding</strong></a></td> <td>Converts categorical data (e.g., words) into dense vectors of fixed size, capturing semantic relationships.</td> <td>NLP tasks like word embeddings (e.g., Word2Vec). Often the first layer in text-based models.</td> <td>Maps high-dimensional sparse data (e.g., one-hot encoded words) to lower-dimensional continuous space.</td> </tr> <tr> <td><a href=#f-attention-scaled-dot-product><strong>Attention</strong></a> (used in Transformers)</td> <td>Allows the model to focus on relevant parts of the input dynamically, weighing their importance. Self-attention computes relationships between all elements.</td> <td>Modern NLP (e.g., GPT models), machine translation, and even vision tasks.</td> <td>Uses queries, keys, and values to compute attention scores, enabling parallel processing of sequences (unlike RNNs).</td> </tr> <tr> <td><a href=#g-normalization-batch-normalization><strong>Normalization</strong></a> (e.g., Batch Normalization, Layer Normalization)</td> <td>Stabilizes training by normalizing activations within a layer, reducing internal covariate shift.</td> <td>Almost all deep networks to speed up training and improve performance.</td> <td>Adjusts and scales activations (e.g., mean to 0, variance to 1) across mini-batches or individual layers.</td> </tr> <tr> <td><a href=#h-dropout><strong>Dropout</strong></a></td> <td>Randomly "drops out" (ignores) a fraction of neurons during training to prevent overfitting.</td> <td>Regularization in any network, especially dense or convolutional ones.</td> <td>Temporarily removes connections, forcing the network to learn redundant representations. Inactive during inference.</td> </tr> <tr> <td><a href=#i-flatten><strong>Flatten</strong></a></td> <td>Converts multi-dimensional data (e.g., from convolutional layers) into a 1D vector for dense layers.</td> <td>Transitioning from feature extraction (CNN) to classification.</td> <td>Reshapes tensors without changing values, e.g., turning a 2D feature map into a flat array.</td> </tr> <tr> <td><a href=#j-activation><strong>Activation</strong></a></td> <td>Applies a non-linear function to the output of other layers (though often built into them). Common ones: ReLU (Rectified Linear Unit), Sigmoid, Tanh, Softmax.</td> <td>Everywhere, to add non-linearity and control output ranges (e.g., Softmax for probabilities).</td> <td>Transforms linear outputs; e.g., ReLU sets negative values to 0 for faster training.</td> </tr> </tbody> </table> <h2 id=common-deep-learning-architectures>Common Deep Learning Architectures</h2> <p>These layers are combined into architectures tailored to specific problems:</p> <ul> <li><strong>Feedforward Neural Networks (FNN)</strong>: Basic stack of dense layers for simple tasks.</li> <li><strong>Convolutional Neural Networks (CNN)</strong>: Convolutional + pooling layers for spatial data like images (e.g., ResNet, VGG).</li> <li><strong>Recurrent Neural Networks (RNN)</strong>: Recurrent layers for sequences (e.g., LSTM for text generation).</li> <li><strong>Transformers</strong>: Attention layers for handling long-range dependencies (e.g., BERT for NLP, Vision Transformers for images).</li> <li><strong>Autoencoders</strong>: Encoder (convolutional/dense) + decoder layers for unsupervised learning like denoising.</li> <li><strong>Generative Adversarial Networks (GANs)</strong>: Combines generator and discriminator networks (often convolutional) for generating realistic data.</li> </ul> <h2 id=forward-and-backward-pass-for-each-layer>Forward and Backward Pass for Each Layer</h2> <p>The forward pass computes the output of each layer given the input, while the backward pass computes gradients for learning.</p> <p>Backpropagation computes the gradient of the loss with respect to the layer's inputs and parameters (e.g., weights, biases) to update them via optimizers like gradient descent. Assume a scalar loss <span class=arithmatex>\( L \)</span>, and upstream gradient <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial y} \)</span> (where <span class=arithmatex>\( y \)</span> is the layer's output) is provided from the next layer.</p> <hr> <h3 id=a-dense-fully-connected>A. Dense (Fully Connected)</h3> <p>Every neuron in this layer is connected to every neuron in the previous layer. It's the most basic type. General-purpose networks, like simple classifiers or regressors. Often used in the final stages of more complex models.</p> <figure> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=https://docscontent.nvidia.com/dita/00000189-949d-d46e-abe9-bcdf9f8c0000/deeplearning/performance/dl-performance-fully-connected/graphics/fc-layer.svg><img alt src=https://docscontent.nvidia.com/dita/00000189-949d-d46e-abe9-bcdf9f8c0000/deeplearning/performance/dl-performance-fully-connected/graphics/fc-layer.svg width=100%></a></p> <figcaption> <p>A sample of a small fully-connected layer with four input and eight output neurons. Source: <a href=https://docs.nvidia.com/deeplearning/performance/dl-performance-fully-connected/index.html target=_blank>Linear/Fully-Connected Layers User's Guide</a></p> </figcaption> </figure> <p><strong>Parameters</strong>:</p> <div class="grid cards"> <ul> <li> <p>x: Input vector.</p> <p>W: Weight matrix.</p> <p>b: Bias vector.</p> </li> <li> <p><span class=arithmatex>\( x = [2, 3] \)</span></p> <p><span class=arithmatex>\( W = \begin{bmatrix} 1 &amp; 2 \\ 0 &amp; -1 \end{bmatrix} \)</span></p> <p><span class=arithmatex>\( b = [1, -1] \)</span></p> </li> </ul> </div> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p><span class=arithmatex>\( y = Wx + b \)</span>,</p> <p>then apply activation (e.g., ReLU: <span class=arithmatex>\( y = \max(0, y) \)</span>).</p> </li> <li> <p><span class=arithmatex>\( y = [9, -4] \)</span>,</p> <p>ReLU: [9, 0].</p> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <ol> <li> <p>Gradient w.r.t. input:</p> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial x} = W^T \cdot \frac{\partial L}{\partial y'} \)</span></p> <p>where <span class=arithmatex>\( y' \)</span> is post-activation,</p> <p>and <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial y'} \)</span> is adjusted for activation,</p> <p>e.g., for ReLU: 1 if <span class=arithmatex>\( y &gt; 0 \)</span>, else 0).</p> </li> <li> <p>Gradient w.r.t. weights:</p> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial W} = \frac{\partial L}{\partial y'} \cdot x^T \)</span>.</p> </li> <li> <p>Gradient w.r.t. bias:</p> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial b} = \sum \frac{\partial L}{\partial y'} \)</span>.</p> </li> </ol> </li> <li> <p>Assume loss gradient <span class=arithmatex>\( \frac{\partial L}{\partial y'} = [0.5, -0.2] \)</span> (post-ReLU). For ReLU: mask = [1, 0], so <span class=arithmatex>\( \frac{\partial L}{\partial y} = [0.5, 0] \)</span>.</p> <ol> <li> <p><span class=arithmatex>\( \begin{align*} \displaystyle \frac{\partial L}{\partial x} &amp;= W^T \cdot [0.5, 0] \\ &amp; = \begin{bmatrix} 1 &amp; 0 \\ 2 &amp; -1 \end{bmatrix} \begin{bmatrix} 0.5 \\ 0 \end{bmatrix} \\ &amp; = [0.5, 1.0] \end{align*} \)</span>.</p> </li> <li> <p><span class=arithmatex>\( \begin{align*} \displaystyle \frac{\partial L}{\partial W} &amp;= [0.5, 0]^T \cdot [2, 3] \\ &amp; = \begin{bmatrix} 1 &amp; 1.5 \\ 0 &amp; 0 \end{bmatrix} \end{align*} \)</span>.</p> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial b} = [0.5, 0] \)</span>.</p> </li> </ol> </li> </ul> </div> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-2--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-2--editor>import numpy as np

def dense_forward(x, W, b):
    y_linear = np.dot(W, x) + b
    y = np.maximum(0, y_linear)  # ReLU
    return y, y_linear  # Cache linear for backprop

def dense_backward(dy_post_act, x, W, y_linear):
    # dy_post_act: ∂L/∂y (post-ReLU)
    dy_linear = dy_post_act * (y_linear &gt; 0)  # ReLU derivative
    dx = np.dot(W.T, dy_linear)
    dW = np.outer(dy_linear, x)
    db = dy_linear
    return dx, dW, db

# Example
x = np.array([2, 3])
W = np.array([[1, 2], [0, -1]])
b = np.array([1, -1])
y, y_linear = dense_forward(x, W, b)
dy_post_act = np.array([0.5, -0.2])
dx, dW, db = dense_backward(dy_post_act, x, W, y_linear)
print("Forward y:", y)  # [9, 0]
print("dx:", dx)  # [0.5, 1.0]
print("dW:", dW)  # [[1, 1.5], [0, 0]]
print("db:", db)  # [0.5, 0]</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-2--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-2--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-2--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=26,
        maxLines=26,
    );
});
</script> <p></p> <hr> <h3 id=b-convolutional>B. Convolutional</h3> <p>Uses filters (kernels) to scan input data, detecting local patterns like edges or textures. Key to "convolutional neural networks" (CNNs). Image and video processing, computer vision (e.g., object detection in photos). Slides filters over the input, computing dot products to create feature maps. Reduces spatial dimensions while preserving important features.</p> <figure> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=https://developer-blogs.nvidia.com/wp-content/uploads/2015/11/convolution.png><img alt src=https://developer-blogs.nvidia.com/wp-content/uploads/2015/11/convolution.png></a></p> <figcaption> <p>Convolution of an image with an edge detector convolution kernel. Sources: <a href=https://developer.nvidia.com/blog/deep-learning-nutshell-core-concepts/#convolutional_deep_learning target=_blank>Deep Learning in a Nutshell: Core Concepts</a></p> </figcaption> </figure> <figure> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=https://developer.nvidia.com/blog/wp-content/uploads/2015/11/Convolution_schematic.gif><img alt src=https://developer.nvidia.com/blog/wp-content/uploads/2015/11/Convolution_schematic.gif></a></p> <figcaption> <p>Calculating convolution by sliding image patches over the entire image. One image patch (yellow) of the original image (green) is multiplied by the kernel (red numbers in the yellow patch), and its sum is written to one feature map pixel (red cell in convolved feature). Image source: <a href=https://developer.nvidia.com/blog/deep-learning-nutshell-core-concepts/#convolutional_deep_learning target=_blank>Deep Learning in a Nutshell: Core Concepts</a></p> </figcaption> </figure> <p><strong>Parameters</strong>:</p> <div class="grid cards"> <ul> <li> <p>X: Input matrix (e.g., image).</p> <p>K: Convolution kernel (filter).</p> <p>b: Bias term.</p> </li> <li> <p>(2D, stride=1, no padding):</p> <p><span class=arithmatex>\( X = \begin{bmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{bmatrix} \)</span></p> <p><span class=arithmatex>\( K = \begin{bmatrix} 1 &amp; 0 \\ -1 &amp; 1 \end{bmatrix} \)</span></p> <p><span class=arithmatex>\( b=1 \)</span></p> </li> </ul> </div> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p>Convolution:</p> <p><span class=arithmatex>\( \displaystyle Y[i,j] = \sum_{m,n} X[i+m, j+n] \cdot K[m,n] + b \)</span>. </p> </li> <li> <p>Convolution:</p> <p><span class=arithmatex>\( \begin{bmatrix} \begin{array}{ll} =&amp; 1 \times 1 + 2 \times 0 \\ &amp;+ 4 \times (-1) + 5 \times 1 \\ &amp;+ 1 \end{array} &amp; \begin{array}{ll} =&amp; 2 \times 1 + 3 \times 0 \\ &amp;+ 5 \times (-1) + 6 \times 1 \\ &amp;+ 1 \end{array} \\ \begin{array}{ll} =&amp; 4 \times 1 + 5 \times 0 \\ &amp;+ 7 \times (-1) + 8 \times 1 \\ &amp;+ 1 \end{array} &amp; \begin{array}{ll} =&amp; 5 \times 1 + 6 \times 0 \\ &amp;+ 8 \times (-1) + 9 \times 1 \\ &amp;+ 1 \end{array} \end{bmatrix} \)</span></p> <p><span class=arithmatex>\( Y = \begin{bmatrix} 3 &amp; 3 \\ -1 &amp; -1 \end{bmatrix} \)</span></p> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <ol> <li> <p>Gradient w.r.t. input:</p> <p>Convolve upstream gradient <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} \)</span> with rotated kernel (full convolution).</p> </li> <li> <p>Gradient w.r.t. kernel:</p> <p>Convolve input <span class=arithmatex>\( X \)</span> with <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} \)</span>.</p> </li> <li> <p>Gradient w.r.t. bias:</p> <p>Sum of <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} \)</span>.</p> </li> </ol> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} = \begin{bmatrix} 0.5 &amp; -0.5 \\ 1 &amp; 0 \end{bmatrix} \)</span>.</p> <ol> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial X} \)</span>:</p> <p>Full conv with rotated K (<span class=arithmatex>\( \begin{bmatrix} 1 &amp; -1 \\ 0 &amp; 1 \end{bmatrix} \)</span>) and padded <span class=arithmatex>\( dY \)</span>, approx. <span class=arithmatex>\( \begin{bmatrix} 0.5 &amp; -0.5 &amp; -0.5 \\ 0 &amp; 1.5 &amp; 0 \\ 1 &amp; 0 &amp; 0 \end{bmatrix} \)</span> (simplified calc).</p> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial K} = \)</span> Conv X with dY:</p> <p><span class=arithmatex>\( \begin{bmatrix} 0.5*1 + (-0.5)*2 + 1*4 + 0*5 \\ \ldots \end{bmatrix} \)</span></p> <p>(detailed in code).</p> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial b} = 0.5 -0.5 +1 +0 = 1 \)</span>.</p> </li> </ol> </li> </ul> </div> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-3--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-3--editor>import numpy as np
from scipy.signal import correlate2d, convolve2d

def conv_forward(X, K, b):
    Y = correlate2d(X, K, mode='valid') + b  # SciPy correlate for conv
    return Y, X  # Cache X

def conv_backward(dY, X, K):
    # Rotate kernel 180 degrees for full conv
    K_rot = np.rot90(K, 2)
    # Pad dY to match X shape for dx
    pad_h, pad_w = K.shape[0]-1, K.shape[1]-1
    dY_padded = np.pad(dY, ((pad_h//2, pad_h-pad_h//2), (pad_w//2, pad_w-pad_w//2)))
    dX = convolve2d(dY_padded, K_rot, mode='valid')
    dK = correlate2d(X, dY, mode='valid')
    db = np.sum(dY)
    return dX, dK, db

# Example
X = np.array([[1,2,3],[4,5,6],[7,8,9]])
K = np.array([[1,0],[-1,1]])
b = 1
Y, _ = conv_forward(X, K, b)
dY = np.array([[0.5, -0.5],[1, 0]])
dX, dK, db = conv_backward(dY, X, K)
print("Forward Y:\n", Y)
print("dX:\n", dX)
print("dK:\n", dK)
print("db:", db)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-3--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-3--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-3--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=29,
        maxLines=29,
    );
});
</script> <p></p> <hr> <h3 id=c-pooling-max-pooling>C. Pooling (Max Pooling)</h3> <p>Downsamples the output from convolutional layers, reducing computational load and preventing overfitting. Types include max pooling (takes the maximum value) and average pooling. Follows convolutional layers in CNNs to summarize features. Aggregates values in small regions (e.g., 2x2 grid) into a single value, making the model more robust to variations like translations.</p> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p><span class=arithmatex>\( Y[i,j] = \max(X[i:i+k, j:j+k]) \)</span> for pool size <span class=arithmatex>\( k \)</span>.</p> </li> <li> <p><span class=arithmatex>\( X = \begin{bmatrix} 1 &amp; 2 &amp; 3 &amp; 4 \\ 5 &amp; 6 &amp; 7 &amp; 8 \\ 9 &amp; 10 &amp; 11 &amp; 12 \\ 13 &amp; 14 &amp; 15 &amp; 16 \end{bmatrix} \)</span>, pool=2, stride=2,</p> <p><span class=arithmatex>\( Y = \begin{bmatrix} 6 &amp; 8 \\ 14 &amp; 16 \end{bmatrix} \)</span>.</p> <ul> <li>Max positions: e.g., 6 from X[1,1]=6, etc.</li> </ul> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p>Distribute upstream gradient <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} \)</span> to the max position in each window; 0 elsewhere.</p> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial Y} = \begin{bmatrix} 0.5 &amp; -0.5 \\ 1 &amp; 0 \end{bmatrix} \)</span>.</p> <ul> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial X} \)</span>:</p> <ul> <li>0.5 to pos of 6 (1,1),</li> <li>-0.5 to pos of 8 (1,3),</li> <li>1 to pos of 14 (3,1),</li> <li>0 to pos of 16 (3,3).</li> <li>Other positions 0.</li> </ul> </li> </ul> </li> </ul> </div> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-4--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-4--editor>import numpy as np

def max_pool_forward(X, pool_size=2, stride=2):
    H, W = X.shape
    out_H, out_W = H // stride, W // stride
    Y = np.zeros((out_H, out_W))
    max_idx = np.zeros_like(X, dtype=bool)  # For backprop
    for i in range(0, H, stride):
        for j in range(0, W, stride):
            slice = X[i:i+pool_size, j:j+pool_size]
            max_val = np.max(slice)
            Y[i//stride, j//stride] = max_val
            max_idx[i:i+pool_size, j:j+pool_size] = (slice == max_val)
    return Y, max_idx

def max_pool_backward(dY, max_idx, pool_size=2, stride=2):
    dX = np.zeros_like(max_idx, dtype=float)
    for i in range(dY.shape[0]):
        for j in range(dY.shape[1]):
            dX[i*stride:i*stride+pool_size, j*stride:j*stride+pool_size] = dY[i,j] * max_idx[i*stride:i*stride+pool_size, j*stride:j*stride+pool_size]
    return dX

# Example
X = np.arange(1,17).reshape(4,4)
Y, max_idx = max_pool_forward(X)
dY = np.array([[0.5, -0.5],[1, 0]])
dX = max_pool_backward(dY, max_idx)
print("Forward Y:\n", Y)
print("dX:\n", dX)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-4--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-4--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-4--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=29,
        maxLines=29,
    );
});
</script> <p></p> <hr> <h3 id=d-recurrent-lstm>D. Recurrent (LSTM)</h3> <p>Recurrent Neural Networks (RNNs) are powerful for sequence data. Long Short-Term Memory (LSTM) networks are a type of RNN designed to capture long-term dependencies and mitigate issues like vanishing gradients.</p> <p><strong>Parameters</strong>:</p> <div class="grid cards"> <ul> <li></li> <li> <p>(Simplified to hidden size=1 for clarity):</p> <ul> <li> <p>Inputs:</p> <p><span class=arithmatex>\( x_t = [0.5] \)</span>,</p> <p><span class=arithmatex>\( h_{t-1} = [0.1] \)</span>,</p> <p><span class=arithmatex>\( C_{t-1} = [0.2] \)</span></p> </li> <li> <p>Weights:</p> <p><span class=arithmatex>\( W_f = [[0.5, 0.5]] \)</span>,</p> <p><span class=arithmatex>\( W_i = [[0.4, 0.4]] \)</span>,</p> <p><span class=arithmatex>\( W_C = [[0.3, 0.3]] \)</span>,</p> <p><span class=arithmatex>\( W_o = [[0.2, 0.2]] \)</span></p> </li> <li> <p>Biases: <span class=arithmatex>\( b_f = b_i = b_C = b_o = [0.0] \)</span></p> </li> </ul> </li> </ul> </div> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <ul> <li>Concatenate: <span class=arithmatex>\( \text{concat} = [h_{t-1}, x_t] \)</span></li> <li>Forget gate: <span class=arithmatex>\( f_t = \sigma(W_f \cdot \text{concat} + b_f) \)</span></li> <li>Input gate: <span class=arithmatex>\( i_t = \sigma(W_i \cdot \text{concat} + b_i) \)</span></li> <li>Cell candidate: <span class=arithmatex>\( \tilde{C}_t = \tanh(W_C \cdot \text{concat} + b_C) \)</span></li> <li>Cell state: <span class=arithmatex>\( C_t = f_t \cdot C_{t-1} + i_t \cdot \tilde{C}_t \)</span></li> <li>Output gate: <span class=arithmatex>\( o_t = \sigma(W_o \cdot \text{concat} + b_o) \)</span></li> <li>Hidden state: <span class=arithmatex>\( h_t = o_t \cdot \tanh(C_t) \)</span></li> </ul> </li> <li> <ul> <li>concat = [0.1, 0.5]</li> <li><span class=arithmatex>\( f_t = \sigma(0.3) \approx 0.5744 \)</span></li> <li><span class=arithmatex>\( i_t = \sigma(0.24) \approx 0.5597 \)</span></li> <li><span class=arithmatex>\( \tilde{C}_t = \tanh(0.18) \approx 0.1785 \)</span></li> <li><span class=arithmatex>\( C_t \approx 0.5744 \cdot 0.2 + 0.5597 \cdot 0.1785 \approx 0.2146 \)</span></li> <li><span class=arithmatex>\( o_t = \sigma(0.12) \approx 0.5300 \)</span></li> <li><span class=arithmatex>\( h_t \approx 0.5300 \cdot \tanh(0.2146) \approx 0.1120 \)</span></li> </ul> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p>Gradients are computed via chain rule:</p> <ul> <li><span class=arithmatex>\( dC_t = dh_t \cdot o_t \cdot (1 - \tanh^2(C_t)) + dC_{next} \)</span> (dC_next from future timestep)</li> <li><span class=arithmatex>\( do_t = dh_t \cdot \tanh(C_t) \cdot \sigma'(o_t) \)</span></li> <li><span class=arithmatex>\( d\tilde{C}_t = dC_t \cdot i_t \cdot (1 - \tilde{C}_t^2) \)</span></li> <li><span class=arithmatex>\( di_t = dC_t \cdot \tilde{C}_t \cdot \sigma'(i_t) \)</span></li> <li><span class=arithmatex>\( df_t = dC_t \cdot C_{t-1} \cdot \sigma'(f_t) \)</span></li> <li><span class=arithmatex>\( dC_{prev} = dC_t \cdot f_t \)</span></li> <li>Then, backpropagate to concat: <span class=arithmatex>\( d\text{concat} = W_o^T \cdot do_t + W_C^T \cdot d\tilde{C}_t + W_i^T \cdot di_t + W_f^T \cdot df_t \)</span></li> <li>Split <span class=arithmatex>\( d\text{concat} \)</span> into <span class=arithmatex>\( dh_{prev} \)</span> and <span class=arithmatex>\( dx_t \)</span></li> <li>Parameter gradients: <span class=arithmatex>\( dW_f = df_t \cdot \text{concat}^T \)</span>, <span class=arithmatex>\( db_f = df_t \)</span>, and similarly for others.</li> </ul> </li> <li> <p>(Assume upstream: <span class=arithmatex>\( dh_t = [0.1] \)</span>, <span class=arithmatex>\( dC_t = [0.05] \)</span> from next timestep):</p> <ul> <li><span class=arithmatex>\( dC_t \approx 0.1 \cdot 0.5300 \cdot (1 - \tanh^2(0.2146)) + 0.05 \approx 0.1028 + 0.05 = 0.1528 \)</span> (detailed steps in code output)</li> <li>Resulting gradients match the executed values below (e.g., <span class=arithmatex>\( dx_t \approx [0.0216] \)</span>, etc.).</li> </ul> </li> </ul> </div> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-5--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-5--editor>import numpy as np

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

def dsigmoid(y):
    return y * (1 - y)

def tanh(x):
    return np.tanh(x)

def dtanh(y):
    return 1 - y**2

# Forward pass
def lstm_forward(x_t, h_prev, C_prev, W_f, W_i, W_C, W_o, b_f, b_i, b_C, b_o):
    concat = np.concatenate((h_prev, x_t), axis=0)
    f_t = sigmoid(np.dot(W_f, concat) + b_f)
    i_t = sigmoid(np.dot(W_i, concat) + b_i)
    C_tilde = tanh(np.dot(W_C, concat) + b_C)
    C_t = f_t * C_prev + i_t * C_tilde
    o_t = sigmoid(np.dot(W_o, concat) + b_o)
    h_t = o_t * tanh(C_t)
    cache = (concat, f_t, i_t, C_tilde, o_t, C_t)
    return h_t, C_t, cache

# Backward pass
def lstm_backward(dh_next, dC_next, cache, W_f, W_i, W_C, W_o):
    concat, f_t, i_t, C_tilde, o_t, C_t = cache

    # Derivatives
    dC_t = dh_next * o_t * dtanh(tanh(C_t)) + dC_next
    do_t = dh_next * tanh(C_t) * dsigmoid(o_t)
    dC_tilde = dC_t * i_t * dtanh(C_tilde)
    di_t = dC_t * C_tilde * dsigmoid(i_t)
    df_t = dC_t * C_prev * dsigmoid(f_t)
    dC_prev = dC_t * f_t

    # Gradients for gates
    dconcat_o = np.dot(W_o.T, do_t)
    dconcat_C = np.dot(W_C.T, dC_tilde)
    dconcat_i = np.dot(W_i.T, di_t)
    dconcat_f = np.dot(W_f.T, df_t)
    dconcat = dconcat_f + dconcat_i + dconcat_C + dconcat_o

    # Split for h_prev and x_t
    hidden_size = h_prev.shape[0]
    dh_prev = dconcat[:hidden_size]
    dx_t = dconcat[hidden_size:]

    # Parameter gradients
    dW_f = np.outer(df_t, concat)
    db_f = df_t
    dW_i = np.outer(di_t, concat)
    db_i = di_t
    dW_C = np.outer(dC_tilde, concat)
    db_C = dC_tilde
    dW_o = np.outer(do_t, concat)
    db_o = do_t

    return dx_t, dh_prev, dC_prev, dW_f, db_f, dW_i, db_i, dW_C, db_C, dW_o, db_o

# Numerical example (hidden size = 1)
x_t = np.array([0.5])
h_prev = np.array([0.1])
C_prev = np.array([0.2])
W_f = np.array([[0.5, 0.5]])
W_i = np.array([[0.4, 0.4]])
W_C = np.array([[0.3, 0.3]])
W_o = np.array([[0.2, 0.2]])
b_f = np.array([0.0])
b_i = np.array([0.0])
b_C = np.array([0.0])
b_o = np.array([0.0])

# Forward
h_t, C_t, cache = lstm_forward(x_t, h_prev, C_prev, W_f, W_i, W_C, W_o, b_f, b_i, b_C, b_o)
print("Forward h_t:", h_t)  # Output: [0.11199714]
print("Forward C_t:", C_t)  # Output: [0.2145628]

# Backward example: assume dh_next = [0.1], dC_next = [0.05]
dh_next = np.array([0.1])
dC_next = np.array([0.05])
dx_t, dh_prev, dC_prev, dW_f, db_f, dW_i, db_i, dW_C, db_C, dW_o, db_o = lstm_backward(dh_next, dC_next, cache, W_f, W_i, W_C, W_o)

print("Backward dx_t:", dx_t)  # Output: [0.02164056]
print("Backward dh_prev:", dh_prev)  # Output: [0.02164056]
print("Backward dC_prev:", dC_prev)  # Output: [0.05780591]
print("Backward dW_f:", dW_f)  # Output: [[0.00049199 0.00245997]]
print("Backward db_f:", db_f)  # Output: [0.00491995]
print("Backward dW_i:", dW_i)  # Output: [[0.00044162 0.00220808]]
print("Backward db_i:", db_i)  # Output: [0.00441615]
print("Backward dW_C:", dW_C)  # Output: [[0.00545376 0.02726878]]
print("Backward db_C:", db_C)  # Output: [0.05453756]
print("Backward dW_o:", dW_o)  # Output: [[0.00052643 0.00263213]]
print("Backward db_o:", db_o)  # Output: [0.00526427]</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-5--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-5--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-5--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=96,
        maxLines=96,
    );
});
</script> <p></p> <div class="admonition info"> <p class=admonition-title>Notes</p> <ul> <li>This is a single-timestep LSTM with hidden size 1 for simplicity. In practice, LSTMs process sequences (multiple timesteps) and have larger hidden sizes; backpropagation through time (BPTT) unrolls the network over timesteps.</li> <li>The code uses NumPy; for real models, use PyTorch or TensorFlow for automatic differentiation and batching.</li> <li>Outputs are approximate due to floating-point precision but match the manual calculations.</li> <li>If you need a multi-timestep example, sequence processing, or integration into a full RNN, let me know!</li> </ul> </div> <hr> <h3 id=e-embedding>E. Embedding</h3> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p><span class=arithmatex>\( y = E[i] \)</span>,</p> <p>where <span class=arithmatex>\( E \)</span> is the embedding matrix,</p> <p><span class=arithmatex>\( i \)</span> is the input index.</p> </li> <li> <p>Index 1,</p> <p><span class=arithmatex>\( E = \begin{bmatrix} 0.1 &amp; 0.2 &amp; 0.3 \\ 0.4 &amp; 0.5 &amp; 0.6 \end{bmatrix}\)</span>,</p> <p><span class=arithmatex>\( y = [0.4,0.5,0.6] \)</span>.</p> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p>Gradient <span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial E[i]} += \frac{\partial L}{\partial y} \)</span>; other rows 0. (Sparse update).</p> </li> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial y} = [0.1, -0.1, 0.2] \)</span>,</p> <p>so add to E[1].</p> </li> </ul> </div> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-6--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-6--editor>import numpy as np

def embedding_forward(index, E):
    return E[index]

def embedding_backward(dy, index, E_shape):
    dE = np.zeros(E_shape)
    dE[index] = dy
    return dE

# Example
E = np.array([[0.1,0.2,0.3],[0.4,0.5,0.6]])
index = 1
y = embedding_forward(index, E)
dy = np.array([0.1, -0.1, 0.2])
dE = embedding_backward(dy, index, E.shape)
print("dE:\n", dE)
</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-6--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-6--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-6--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=17,
        maxLines=17,
    );
});
</script> <p></p> <hr> <h3 id=f-attention-scaled-dot-product>F. Attention (Scaled Dot-Product)</h3> <p><strong>Forward Pass</strong>: <span class=arithmatex>\( \text{Attention} = \text{softmax}\left(\frac{QK^T}{\sqrt{d}}\right)V \)</span>.</p> <p><strong>Backward Pass</strong>: Gradients for Q, K, V via chain rule on softmax and matmuls.</p> <p><strong>Numerical Example</strong>: Use previous. Backward is matrix derivs; code handles.</p> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-7--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-7--editor>import numpy as np

def softmax(x):
    exp_x = np.exp(x - np.max(x, axis=-1, keepdims=True))
    return exp_x / np.sum(exp_x, axis=-1, keepdims=True)

def attention_forward(Q, K, V):
    d = Q.shape[-1]
    scores = np.dot(Q, K.T) / np.sqrt(d)
    weights = softmax(scores)
    attn = np.dot(weights, V)
    return attn, (scores, weights, K, V)  # Cache

def attention_backward(dattn, cache):
    scores, weights, K, V = cache
    dweights = np.dot(dattn, V.T)
    dscores = weights * (dweights - np.sum(weights * dweights, axis=-1, keepdims=True))
    dQ = np.dot(dscores, K) / np.sqrt(K.shape[-1])
    dK = np.dot(dscores.T, Q) / np.sqrt(K.shape[-1])
    dV = np.dot(weights.T, dattn)
    return dQ, dK, dV

# Example
Q = K = V = np.array([[1.,0.],[0.,1.]])
attn, cache = attention_forward(Q, K, V)
dattn = np.array([[0.1,0.2],[ -0.1,0.3]])
dQ, dK, dV = attention_backward(dattn, cache)
print("dQ:\n", dQ)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-7--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-7--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-7--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=28,
        maxLines=28,
    );
});
</script> <p></p> <hr> <h3 id=g-normalization-batch-normalization>G. Normalization (Batch Normalization)</h3> <p><strong>Forward Pass</strong>: Normalize, scale, shift.</p> <p><strong>Backward Pass</strong>: Gradients for input, gamma, beta via chain rule on mean/var.</p> <p><strong>Numerical Example</strong>: Previous forward. Backward computes dx, dgamma, dbeta.</p> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-8--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-8--editor>import numpy as np

def batch_norm_forward(x, gamma, beta, epsilon=1e-4):
    mu = np.mean(x)
    var = np.var(x)
    x_hat = (x - mu) / np.sqrt(var + epsilon)
    y = gamma * x_hat + beta
    return y, (x_hat, mu, var)

def batch_norm_backward(dy, cache, gamma):
    x_hat, mu, var = cache
    N = dy.shape[0]
    dx_hat = dy * gamma
    dvar = np.sum(dx_hat * (x - mu) * -0.5 * (var + epsilon)**(-1.5), axis=0)
    dmu = np.sum(dx_hat * -1 / np.sqrt(var + epsilon), axis=0) + dvar * np.mean(-2 * (x - mu), axis=0)
    dx = dx_hat / np.sqrt(var + epsilon) + dvar * 2 * (x - mu) / N + dmu / N
    dgamma = np.sum(dy * x_hat, axis=0)
    dbeta = np.sum(dy, axis=0)
    return dx, dgamma, dbeta

# Example
x = np.array([1,2,3,4.])
gamma, beta = 1, 0
y, cache = batch_norm_forward(x, gamma, beta)
dy = np.array([0.1,0.2,-0.1,0.3])
dx, dgamma, dbeta = batch_norm_backward(dy, cache, gamma)
print("dx:", dx)
print("dgamma:", dgamma)
print("dbeta:", dbeta)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-8--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-8--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-8--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=29,
        maxLines=29,
    );
});
</script> <p></p> <hr> <h3 id=h-dropout>H. Dropout</h3> <figure> <p><a class=glightbox data-desc-position=bottom data-height=auto data-type=image data-width=auto href=dropout.png><img alt src=dropout.png width=90%></a></p> <figcaption> <p>Dropout Neural Net Model. Left: A standard neural net with 2 hidden layers. Right: An example of a thinned net produced by applying dropout to the network on the left. Crossed units have been dropped. Source: <a href=https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf target=_blank>Dropout: A Simple Way to Prevent Neural Networks from Overfitting</a></p> </figcaption> </figure> <p><strong>Forward Pass</strong>: Mask during training.</p> <p><strong>Backward Pass</strong>: Same mask applied to upstream gradient (scale by 1/(1-p)).</p> <p><strong>Numerical Example</strong>: Same as forward; backward passes dy through mask.</p> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-9--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-9--editor>import numpy as np

def dropout_forward(x, p, training=True):
    if training:
        mask = np.random.binomial(1, 1-p, size=x.shape) / (1-p)
        y = x * mask
        return y, mask
    return x, None

def dropout_backward(dy, mask):
    if mask is None:
        return dy
    return dy * mask

# Example
np.random.seed(0)
x = np.array([1,2,3,4.])
p = 0.5
y, mask = dropout_forward(x, p)
dy = np.array([0.1,0.2,0.3,0.4])
dx = dropout_backward(dy, mask)
print("dx:", dx)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-9--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-9--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-9--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=22,
        maxLines=22,
    );
});
</script> <p></p> <hr> <h3 id=i-flatten>I. Flatten</h3> <p><strong>Forward Pass</strong>: Reshape to 1D.</p> <p><strong>Backward Pass</strong>: Reshape upstream gradient back to original shape.</p> <p><strong>Numerical Example</strong>: - Forward: 2x2 to [1,2,3,4]. - Backward: dy = [0.1,0.2,0.3,0.4] -&gt; reshape to 2x2.</p> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-10--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-10--editor>import numpy as np

def flatten_forward(x):
    return x.flatten(), x.shape

def flatten_backward(dy, orig_shape):
    return dy.reshape(orig_shape)

# Example
x = np.array([[1,2],[3,4]])
y, shape = flatten_forward(x)
dy = np.array([0.1,0.2,0.3,0.4])
dx = flatten_backward(dy, shape)
print("dx:\n", dx)
</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-10--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-10--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-10--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=14,
        maxLines=14,
    );
});
</script> <p></p> <h3 id=j-activation-relu>J. Activation (ReLU)</h3> <p><strong>Forward Pass</strong>:</p> <div class="grid cards"> <ul> <li><span class=arithmatex>\( y = \max(0, x) \)</span>. </li> <li> <p><span class=arithmatex>\( x = [-1, 0, 2, -3] \)</span>,</p> <p><span class=arithmatex>\( y = [0, 0, 2, 0] \)</span>.</p> </li> </ul> </div> <p><strong>Backward Pass</strong>:</p> <div class="grid cards"> <ul> <li> <p><span class=arithmatex>\( \displaystyle \frac{\partial L}{\partial x} = \frac{\partial L}{\partial y} \cdot (x &gt; 0) \)</span>.</p> </li> <li> <p><span class=arithmatex>\( dy = [0.5,-0.5,1,0] \)</span>,</p> <p><span class=arithmatex>\( dx = [0,0,1,0] \)</span> (masked).</p> </li> </ul> </div> <p><strong>Implementation</strong>:</p> <p> <script src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js type=text/javascript></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js type=text/javascript></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js type=text/javascript></script> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css rel="alternate stylesheet" title=light> <link disabled=disabled href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css rel="alternate stylesheet" title=dark> </p><div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span class="pyodide-bar-item pyodide-clickable" id=exec-11--run title="Run: press Ctrl-Enter"><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre class=pyodide-editor id=exec-11--editor>import numpy as np

def relu_forward(x):
    return np.maximum(0, x), x

def relu_backward(dy, x_cache):
    return dy * (x_cache &gt; 0)

# Example
x = np.array([-1,0,2,-3])
y, x_cache = relu_forward(x)
dy = np.array([0.5,-0.5,1,0])
dx = relu_backward(dy, x_cache)
print("dx:", dx)
</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span class="pyodide-bar-item pyodide-clickable" id=exec-11--clear><span class=twemoji><svg viewbox="0 0 24 24" xmlns=http://www.w3.org/2000/svg><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code class=pyodide-output id=exec-11--output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-11--',
        install=['pandas', 'scikit-learn'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=14,
        maxLines=14,
    );
});
</script> <p></p> <div class=footnote> <hr> <ol> <li id=fn:1> <p>Mohd Halim Mohd Noor, Ayokunle Olalekan Ige: <a href=https://arxiv.org/pdf/2403.17561 target=_blank>A Survey on State-of-the-art Deep Learning Applications and Challenges</a>, 2025.&nbsp;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">↩</a></p> </li> <li id=fn:2> <p>Aston Zhang, Zachary C. Lipton, Mu Li, and Alexander J. Smola: <a href=https://d2l.ai/ target=_blank>Dive into Deep Learning</a>, 2020.&nbsp;<a class=footnote-backref href=#fnref:2 title="Jump back to footnote 2 in the text">↩</a></p> </li> <li id=fn:3> <p>Ian Goodfellow, Yoshua Bengio, Aaron Courville: <a href=https://www.deeplearningbook.org/ target=_blank>Deep Learning</a>, 2016.&nbsp;<a class=footnote-backref href=#fnref:3 title="Jump back to footnote 3 in the text">↩</a></p> </li> <li id=fn:4> <p>Johannes Schneider, Michalis Vlachos: <a href=https://arxiv.org/abs/2302.00722 target=_blank>A Survey of Deep Learning: From Activations to Transformers</a>, 2024.&nbsp;<a class=footnote-backref href=#fnref:4 title="Jump back to footnote 4 in the text">↩</a></p> </li> <li id=fn:5> <p>Goodfellow, I., Bengio, Y., &amp; Courville, A. (2016). <a href=https://www.deeplearningbook.org/ target=_blank>Deep Learning</a>. MIT Press.&nbsp;<a class=footnote-backref href=#fnref:5 title="Jump back to footnote 5 in the text">↩</a></p> </li> <li id=fn:6> <p><a href=https://adeshpande3.github.io/ target=_blank>Adit Deshpande</a> is a comprehensive resource for learning about deep learning, covering various topics such as neural networks, convolutional neural networks (CNNs), recurrent neural networks (RNNs), and more. It provides detailed explanations, code examples, and practical applications of deep learning concepts, making it suitable for both beginners and advanced learners.&nbsp;<a class=footnote-backref href=#fnref:6 title="Jump back to footnote 6 in the text">↩</a></p> </li> <li id=fn:7> <p><a href=https://fleuret.org/francois/lbdl.html target=_blank>François Fleuret</a> offers a collection of deep learning resources, including lectures, tutorials, and research papers, aimed at helping learners understand and apply deep learning techniques effectively.&nbsp;<a class=footnote-backref href=#fnref:7 title="Jump back to footnote 7 in the text">↩</a></p> </li> </ol> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 6, 2025 12:06:33 UTC">November 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="November 6, 2025 12:06:33 UTC">November 6, 2025</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 4a4 4 0 0 1 4 4 4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4m0 10c4.42 0 8 1.79 8 4v2H4v-2c0-2.21 3.58-4 8-4"></path></svg> </span> <nav> <a href=mailto:hsandmann@ieee.org>Humberto Sandmann</a> </nav> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/hsandmann class=md-author title=@hsandmann> <img src="https://avatars.githubusercontent.com/u/20843348?v=4&size=72" alt=hsandmann> </a> </nav> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "content.code.select", "content.code.annotate", "content.tooltips", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.path", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=../../assets/javascripts/mathjax.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=../../assets/javascripts/badge.js async></script> <script src=../../termynal.js></script> <script id=init-glightbox>const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>